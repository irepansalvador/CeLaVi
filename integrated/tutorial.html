<!DOCTYPE html>
<html lang="en">
<title>CeLaVi tutorial</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif;}
.w3-sidebar {
  z-index: 3;
  width: 350px;
  top: 70px;
  bottom: 0;
  height: inherit;
}

.w3-main {
	 z-index: -1;
	margin-left:350px;
}
</style>


<body>

<!-- Navbar -->
<div class="w3-top" >
  <div class="w3-bar w3-theme w3-top w3-left-align w3-large" style="width: 350px" >
    <a class="w3-bar-item w3-button w3-right w3-hide-large w3-hover-white w3-large w3-theme-l1" href="javascript:void(0)" onclick="w3_open()"><i class="fa fa-bars"></i></a>
    <h1><b>CeLaVi</b> tutorial</h1>
  </div>
</div>

<!-- Sidebar -->
<nav class="w3-sidebar w3-bar-block w3-collapse w3-large w3-theme-l5 w3-animate-left"  id="mySidebar">
	<a href="javascript:void(0)" onclick="w3_close()" class="w3-right w3-large w3-padding-large w3-hover-black w3-hide-large" title="Close Menu">
	<i class="fa fa-remove"></i>
	</a>
	<h4 class="w3-bar-item"><b>Menu</b></h4>
	<ol>
		<li><a class="tocxref" href="#h-1">Opening Input files</a> 
			<ol>
				<li><a class="tocxref" href="#h-1.1">Cell Lineage Tree file</a></li>
				<li><a class="tocxref" href="#h-1.2">3D coordinates file</a></li>
			</ol>
		</li>
		<li><a class="tocxref" href="#h-2">Interacting with the Lineage Tree</a> 
			<ol>
				<li><a class="tocxref" href="#h-2.1">Collapsing/Expanding daughters of one cell</a></li>
				<li><a class="tocxref" href="#h-2.2">Collapsing/Expanding all descendants of one cell</a></li>
				<li><a class="tocxref" href="#h-2.3">Collapsing/Expanding all cells from a given tree depth</a></li>
			</ol>
		</li>
		<li><a class="tocxref" href="#h-3">Interacting with cells in the 3D viewer</a> 
			<ol>
				<li><a class="tocxref" href="#h-3.1">Rotate/zoom/pan</a></li>
				<li><a class="tocxref" href="#h-3.2">Modifying cell features</a></li>
				<li><a class="tocxref" href="#h-3.3">Highlighting the lineage history of a cell</a></li>
			</ol>
		</li>
		<li><a class="tocxref" href="#h-4">Visualising clones</a> 
			<ol>
				<li><a class="tocxref" href="#h-4.1">Showing a single clone</a></li>
				<li><a class="tocxref" href="#h-4.2">Showing clones from a given tree depth</a></li>
				<li><a class="tocxref" href="#h-4.3">Showing clones from a given time point</a></li>
				<li><a class="tocxref" href="#h-4.4">Saving clones</a></li>
			</ol>
		</li>
		<li><a class="tocxref" href="#h-5">About test files</a> 
			<ol>
					<li><a class="tocxref" href="#h-5.1"><i>Caenorhabditis elegans</i></a></li>
					<li><a class="tocxref" href="#h-5.2"><i>Parhyale</i> limb</a></li>
					<li><a class="tocxref" href="#h-5.1">Organoid</a></li>
			</ol>
		</li>
		<li><a class="tocxref" href="#h-6">References</a> 
		</li>
</ol>
</nav>

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- Main content: shift it to the right by 250 pixels when the sidebar is visible -->
<div class="w3-main" style="margin-left:350px">
	<div class="w3-row w3-padding-64">
		<div class="w3-half w3-container">
			<h2 class="w3-text-teal"><a name="h-1"></a> Wecome to the CeLaVi tutorial!</h2>
			<p>
			CeLaVi is a web-server based visualisation tool 
			that allows any user to interrogate interactively the cell 
			lineage of an organism or population of cells whilst visualising
			its spatial context and identity of the cells.<br>
			CeLaVi is built using HTML5, Ajax, jQuery, CSS and the
			visualisation libraries D3.js and Plotly.js. It does not need to
			be installed and has been tested on the following browsers and
			OS:

			<table class="w3-table w3-bordered">
					<tbody>
							<tr>
									<td>OS</td>
									<td>Version</td>
									<td>Chrome</td>
									<td>Firefox</td>
									<td>Safari</td>
							</tr>
							<tr>
									<td>Linux</td>
									<td>Ubuntu 16.04</td>
									<td>79.0</td>
									<td>71.0</td>
									<td>n/a</td>
							</tr>
							<tr>
									<td>MacOS</td>
									<td>10.15.2</td>
									<td>79.0</td>
									<td>71.0</td>
									<td>13.0.4</td>
							</tr>
							<tr>
									<td>Windows</td>
									<td>10</td>
									<td>79.0</td>
									<td>71.0</td>
									<td>n/a</td>
							</tr>
					</tbody>
			</table>

					</p>
					<h2 class="w3-text-teal"><a name="h-1">1.</a> Opening Input files</h2>
			<p>To visualize a Cell Lineage Tree and relate it to a 3D cell map, the user needs to provide two files.
			</p>
			<h3 class="w3-text-teal"><a name="h-1.1">1.1</a> Cell lineage tree file</h3>
			<p>
			The tree file needs to be uploaded either in Newick or Json format. 
			To upload a tree file, click the "Upload tree (select format)" box and choose the file to upload. After uploading, specify if the file is in a Newick or Json format. Also, specify if the tree file contains "Absolute" or "Relative" branch lengths, or no branch lengths at all (to understand the difference between "Relative" and "Absolute" see to the "Branch Lengths" section). Finally, click on "Submit" to visualise the Cell Lineage Tree.	
			</p>
			<h3 class="w3-text-teal"><a name="h-1.2">1.2</a> 3D coordinates
			file</h3>
			<p>
			The file containing the 3D coordinates of the cells must be a table in comma- separated-value (csv) format. The first line is a header or descriptor line, which specifies the column’s identity as “cell”, “X”, “Y”, and “Z”. Each subsequent line corresponds to one cell. The first column contains the cell ID, and the next columns arethe three coordinate values (X,Y and Z, respectively).
			</p>
		</div>
		<div class="w3-half w3-container">
			<p class=" w3-padding-large w3-padding-32 w3-center">
			<video style='border: 3px solid black;' width="400" controls>
			<source src="./Videos/Input_files_new.mp4" type="video/mp4">
			Your browser does not support the video tag.
			</video>
			</p>
		</div>
	</div>
	<!-- Interact with cell lineage tree  -->
	<div class="w3-row w3-padding-64">
		<div class="w3-half w3-container">
			<h2 class="w3-text-teal"><a name="h-2">2.</a> Interacting with the
			Lineage tree</h2>
			<p>
			Once a cell lineage tree has been uploaded, by default the tree shows only the first generation of  descendants of the root, visualising a “collapsed” tree.
			</p>
			<p>
			Any  cell in the tree is labeled either in blue or white, representing one of two states:a "collapsed" state (labeled in blue), in which its daughter cells are hidden, or an "expanded" state (labeled in white), in which its daughter cells are shown. Terminal cells in the tree do not have daughters, and are by definition in the "expanded" state. Clicking on an internal cell in the lineage tree will switch between the "collapsed" (blue) and "expanded" (white) states.
			</p>
			<h3 class="w3-text-teal"><a name="h-2.1">2.1</a>
					Collapsing/Expanding the daughters of one cell</h3>
			<p>
			Any  cell in the tree is labeled either in blue or white, representing one of two states:a "collapsed" state (labeled in blue), in which its daughter cells are hidden, or an "expanded" state (labeled in white), in which its daughter cells are shown. Terminal cells in the tree do not have daughters, and are by definition in the "expanded" state. Clicking on an internal cell in the lineage tree will switch between the "collapsed" (blue) and "expanded" (white) states.
			</p>
			<h3 class="w3-text-teal"><a name="h-2.2">2.2</a>
			Collapsing/Expanding all descendants of one cell</h3>
			<p>
			Any  cell in the tree is labeled either in blue or white, representing one of two states:a "collapsed" state (labeled in blue), in which its daughter cells are hidden, or an "expanded" state (labeled in white), in which its daughter cells are shown. Terminal cells in the tree do not have daughters, and are by definition in the "expanded" state. Clicking on an internal cell in the lineage tree will switch between the "collapsed" (blue) and "expanded" (white) states.
			</p>
				
			<h3 class="w3-text-teal"><a name="h-2.3">2.3</a>
			Collapsing/Expanding all cells from a given tree depths</h3>
			<p>
			This is an option to expand/collapse daughters of many cells at once by using the "Tree depth" section below the cell lineage. When loading a tree, CeLaVi displays the different depths of the tree as purple circles in the "Tree depth" section. 
			These circles, as well as showing the number of depth levels, can be used to collapse/expand all the cells at a given tree depth:click the depth level of interest, select the option "Collapse all cells" or "Expand all cells". 
			Please note that the tree levels are defined in ascending order, starting with the root at level 0, the daughters of the root cell as level 1, and so on. 
			NOTE: This option is only available when the tree is not in the "Show Branchlength (BL)" mode. For information on this see the section "Branchlength mode"
			In the following video both functions are shown.
			</p>
		</div>
		<div class="w3-half w3-container">
			<p class=" w3-padding-large w3-padding-32 w3-center">
			<video style='border: 3px solid black;' width="400" controls>
			<source src="./Videos/Collapse_all_new.mp4" type="video/mp4">
			Your browser does not support the video tag.
			</video>
			</p>
			
			<p class=" w3-padding-large w3-padding-32 w3-center">
			<video style='border: 3px solid black;' width="400" controls>
			<source src="./Videos/Tree_depth_new.mp4" type="video/mp4">
			Your browser does not support the video tag.
			</video>
			<br>
			Tree depth
			</p>
		</div>
	</div>
	<!-- Interact with the 3D cells  -->
	<div class="w3-row w3-padding-64">
		<div class="w3-half w3-container">
			<h2 class="w3-text-teal"><a name="h-3">3.</a> Interacting with
			cells in the 3D viewer</h2>
			<p>
			The 3D visualisation is implemented using the 3D scatterplot function of plotly.js, a visualisation library based on d3.js and stack.gl
			For more information on the plotly.js visualisation library visit https://plot.ly/javascript/.

			</p>
			<h3 class="w3-text-teal"><a name="h-3.1">3.1</a> Rotate/zoom/pan</h3>
			<p>
			With a 3D file of cell locations uploaded, the positions of all cells are shown on the right hand side in the 3D viewer. It is possible to Zoom in/out, rotate and pan the 3D scatterplot by selecting the function and dragging the mouse. All options are located in a panel at the top right of the 3D viewer area.
			</p>
			<h3 class="w3-text-teal"><a name="h-3.2">3.2</a> Modifying cell representation</h3>
			<p>
			The user can modify some of the features of the 3D cells using the "3D cell controls" panel, located in the top right of the viewer area. There are 3 boxes in this section: 1) the box on the left  ("Reset cols" clickable button) resets the colour of the cells to the default (light grey). 2) The box in the middle allows one to change the size of the cells in a stepwise manner using the arrow buttons or by directly typing an integer value. The box on the right allows to change the stroke width of the outline of the cell.
			</p>
			<h3 class="w3-text-teal"><a name="h-3.3">3.3</a> Highlighting the lineage history of a cell</h3>
			<p>
			An important feature of CeLaVi is the possibility of interactively interrogating the data. A fundamental function is to highlight the developmental lineage of any chosen cell in the 3D visualisation area. Clicking on any cell in the 3D visualisation will change its colour to red and its lineage will be highlighted in red in the lineage tree. More specifically, the cell that has been clicked and all its ancestors down to the root will be coloured in red.
			<b>		Note: To do this, the lineage tree (or at least the clade of the cell to be highlighted) needs to be completely expanded..<br> </b>
			</p>
		</div>
		<div class="w3-half w3-container">
			<p class=" w3-padding-large w3-padding-32 w3-center">
			<video style='border: 3px solid black;' width="400" controls>
			<source src="./Videos/click_3D_new.mp4" type="video/mp4">
			Your browser does not support the video tag.
			</video>
			<br>
			Interacting with cells in the 3D viewer
		</p>
		</div>
	</div>
	<!-- Visualising clones  -->
	<div class="w3-row w3-padding-64">
		<div class="w3-half w3-container">
			<h2 class="w3-text-teal"><a name="h-4">4.</a> 
			Visualising clones</h2>
			<h3 class="w3-text-teal"><a name="h-4.1">4.1</a> Showing a single clone</h3>
			<p>
			There are two ways to visualise the spatial distribution of all the descendants of a given cell in the cell lineage. The first is by right clicking on any cell in the Lineage tree to display the options menu. From the menu select the option "Show descendants". This will mark all the descendant cells on the 3D visualisation section by changing their colour (the default option is changing to light blue). With this option we can mark many clones at the same time (the  newly marked clones will have different default colours). 
			Another option is to click on the "Show descendants" click box at the bottom. This option automatically marks clones when hovering the mouse cursor over any cell in the lineage tree. In this case, the colour of the cells that do not belong to the visualised clone will change to default colour (light grey), meaning that this function only allows to visualise one clone at a time.The following video shows the both options to highlight a single clone in the 3D cell section; how to interact with the 3D plot; and how to highlight the developmental lineage of a specific cell.

			</p>
			<p>
			Another option is to click on the "Show descendants" click box at the bottom. This option automatically marks clones when hovering the mouse cursor over any cell in the lineage tree. In this case, the colour of the cells that do not belong to the visualised clone will change to default colour (light grey), meaning that this function only allows to visualise one clone at a time.The following video shows the both options to highlight a single clone in the 3D cell section; how to interact with the 3D plot; and how to highlight the developmental lineage of a specific cell.
			</p>
			<p> The following video shows the both options to highlight a single clone
			in the 3D cell section; how to interact with the 3D plot; and how to 
			highlight the developmental lineage of a specific cell.
			</p>
			<h3 class="w3-text-teal"><a name="h-4.2">4.2</a> 
					Showing clones from a given tree depth</h3>
			<p>
			It is possible to mark all the clones at a given tree depth by interacting with the "Tree depth" section below the Lineage Tree. In the accompanying video this function is shown using the Parhyale dataset. Clicking on the depth level 1 circle we can then select the option "Show clones from this depth". This marks the spatial distribution of the 20 clones that comprise this dataset. We can also use this option to see how a clone gets divided into subclones in the subsequent cell divisions. For this we need to expand only the clone(s) we are interested in following, and then select the option "Show clones from this depth" for increasing depths (see video).
			</p>
			<h3 class="w3-text-teal"><a name="h-4.3">4.3</a> 
					Showing clones arising at a given time point</h3>
			<p>
			When the Cell Lineage file contains branch lengths (BL) information (which essentially  represents the timing of cell divisions), it is also possible to show all the clones produced at a given time point. To do this, first click the button "Show BL" to change the shape of the Lineage tree so that it shows the branch lengths. The "Tree depth" section at the bottom of the Lineage Tree will change from showing the tree depths (purple circles) to showing an horizontal slider. The horizontal slider represents developmental time and can be clicked to show the clones originated at different time points. To facilitate the visualisation, a vertical dashed line is plotted on top of the Lineage Tree. As when showing the clones at a given depth, it is possible to expand only those clones in the lineage tree that the user wants to visualise. 
			The following video shows how to visualise clones at a given tree depth or at a given time point. 
 
			</p>
			<p>
			The following video shows how to visualise clones at a given
			tree depth or at a given time point.
			</p>
			<h3 class="w3-text-teal"><a name="h-4.4">4.4</a> Saving clones</h3>
			<p>
			If the user is interested in one or several specific clones, it is possible to save these to a list that can be used to visualise them later. In the Lineage tree we right-click on the tree node (parent cell) of interest and select the option "Save clone". This will save the identifier of this parent cell into a list that can be displayed by clicking on the button "Saved clones". We can then recall a saved clone by clicking on any element of this list. This will highlight the selected clone by colouring the cells within the clone with a randomly chosen colour. 
			The video below shows how to save clones and how to select them from the list to display them.

			</p>
			<p>
			The video below shows how to save clones and how to select them from the list
			to display them.
			</p>
		</div>
		<div class="w3-half w3-container">
			<p class=" w3-padding-large w3-padding-32 w3-center">
			<video style='border: 3px solid black;' width="400" controls>
			<source src="./Videos/single_clones_new.mp4" type="video/mp4">
			Your browser does not support the video tag.
			</video>
			<br>
			Showing a single clone
			</p>
			<p class=" w3-padding-large w3-padding-32 w3-center">
			<video style='border: 3px solid black;' width="400" controls>
			<source src="./Videos/various_clones_new.mp4" type="video/mp4">
			Your browser does not support the video tag.
			</video>
			<br>
			Showing various clones
			</p>
			<p class=" w3-padding-large w3-padding-32 w3-center">
			<video style='border: 3px solid black;' width="400" controls>
			<source src="./Videos/save_clones_new.mp4" type="video/mp4">
			Your browser does not support the video tag.
			</video>
			<br>
			Saving clones
			</p>
		</div>
	</div>
	<!-- About examples  -->
	<div class="w3-row w3-padding-64">
		<div class="w3-half w3-container">
			<h2 class="w3-text-teal"><a name="h-5">5.</a> 
			About test files</h2>
			<h3 class="w3-text-teal"><a name="h-5.1">5.1</a><i> Caenorhabditis elegans</i></h3>
			<p>
			The embryonic cell lineage of the nematode  <i>C. elegans</i> was described by 
			John Sulston and collaborators in 1983<a href="#h-r1">[1]</a>.
			The data used for the cell lineage and the cell types were extracted from a
			json file available made available by Nikhil Bhatla at 
			wormweb.org/celllineage<br>
			The 3D coordinates come from the study of Fuhui Long and
			collaborators<a href="#h-r2">[2]</a>, where they mapped 357 cells (out of the 558
			cells) of the L1 larval stage, using confocal image stacks of 15
			individual worms.
			</p>
			<h3 class="w3-text-teal"><a name="h-5.2">5.2</a><i> Parhyale</i> limb</h3>
			<p>
			The cell lineage and 3D coordinates of the limb of the crustaean
			<i>Parhyale hawaiensis</i> were obtained by Tassos Pavlopoulos and
			collaborators<a href="#h-r3">[3]</a>. They imaged transgenic fluorescently-labeled 
			embryos with multi-view light-sheet microscopy at high spatiotemporal
			resolution over several days of embryogenesis.
			The cell lineage was then reconstructed with the aid of the MaMuT software.<br>
			</p>
			<h3 class="w3-text-teal"><a name="h-5.2">5.2</a><i> In silico</i> Organoid</h3>
			<p>
			The "organoid" dataset comes from a simulation of morphogenesis
			using the ya||a software<a href="#h-r4">[4]</a>. The organoid is
			the product of a branching morphogenesis simulation with epithelium 
			and mesenchyme (only the epithelium is used for the example).
			The simulation was kindly provided by Miquel Marín-Riera,
			coauthor of the ya||a software, and is based on the example 
			"branching.cu" available in https://github.com/germannp/yalla.
			</p>
		</div>
	<!-- References  -->
	<div class="w3-row w3-padding-64">
		<div class="w3-half w3-container">
			<h2 class="w3-text-teal"><a name="h-6">6.</a> References</h2>
			<p>
			<a name="h-r1">[1]</a> Sulston JE, Schierenberg E, White JG, Thomson JN. The
			embryonic cell lineage of the nematode Caenorhabditis elegans.
			Dev Biol. 1983;100(1):64-119.
			doi:10.1016/0012-1606(83)90201-4<br><br>

			<a name="h-r2">[2]</a> Long F, Peng H, Liu X, Kim SK, Myers
			E. A 3D digital atlas of C. elegans and its application to
			single-cell analyses. Nat Methods. 2009;6(9):667-672.
			doi:10.1038/nmeth.1366<br><br>

			<a name="h-r3">[3]</a> Wolff C, Tinevez J-Y, Pietzsch T, et al.
			Multi-view light-sheet imaging and tracking with the MaMuT
			software reveals the cell lineage of a direct developing
			arthropod limb. Elife. 2018;7. doi:10.7554/eLife.34410<br><br>

			<a name="h-r4">[4]</a> Germann P, Marin-Riera M, Sharpe J.
			ya||a: GPU-Powered Spheroid Models for Mesenchyme and
			Epithelium. Cell Syst. 2019;8(3):261-266.e3.
			doi:10.1016/J.CELS.2019.02.007<br><br>
		</p>
		</div>
	</div>
</div>



  <!-- Pagination 
  <div class="w3-center w3-padding-32">
    <div class="w3-bar">
      <a class="w3-button w3-black" href="#h-1">1</a>
      <a class="w3-button w3-hover-black" href="#h-2">2</a>
      <a class="w3-button w3-hover-black" href="#">3</a>
      <a class="w3-button w3-hover-black" href="#">4</a>
      <a class="w3-button w3-hover-black" href="#">5</a>
      <a class="w3-button w3-hover-black" href="#">»</a>
    </div>
  </div>
 -->
  <footer id="myFooter">
    <div class="w3-container w3-theme-l2 w3-padding-32">
				<h5>The development of celavi.pro is funded by<br>
					the Human Frontiers Science Program (HFSP)</h5>
			<img src="HFSP_logo.jpg" alt="HFSP_logo" width="150" >
    </div>

    <div class="w3-container w3-theme-l1">
      <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
    </div>
  </footer>

<!-- END MAIN -->
</div>

<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
  if (mySidebar.style.display === 'block') {
    mySidebar.style.display = 'none';
    overlayBg.style.display = "none";
  } else {
    mySidebar.style.display = 'block';
    overlayBg.style.display = "block";
  }
}

// Close the sidebar with the close button
function w3_close() {
  mySidebar.style.display = "none";
  overlayBg.style.display = "none";
}
</script>

</body>
</html>
